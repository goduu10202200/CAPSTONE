<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>VALOUR</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.png" />

    <!-- 圖片切換 -->
    <link href="./css/simpleLightbox.min.css" rel="stylesheet" />

    <!-- 動畫 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

    <!-- 幻燈片 -->
    <!-- <link href="./css/swiper.min.css" rel="stylesheet" /> -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />

    <link href="./css/styles.css" rel="stylesheet" />

</head>

<body id="page-top">
    <!-- 選單 - S 2021/09/17 -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class=" navbar-brand nav-link" service="home" href="">
                <img id="cs_logo" class="img-small top-img" src="./assets/img/logo_white.png" alt="VALOUR" />
            </a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <!-- 選單 -->
                <ul id="menu" class="navbar-nav ms-auto my-2 my-lg-0"></ul>

                <!-- <ul class="navbar-nav ms-auto my-2 my-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#about" id="navbarScrollingDropdown"
                            data-bs-toggle="dropdown" aria-expanded="false">TestDropDown</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarScrollingDropdown">
                            <li class="dropdown dropdown-submenu">
                                <a class="dropdown-item dropdown-item-link nav-link" href="#"
                                    data-toggle="dropdown">Services</a>
                               子選單 
                                <ul class="dropdown-menu">
                                    <li>
                                        <a class="dropdown-item dropdown-item-link nav-link" href="#">Services</a>
                                    </li>
                                </ul>
                                子選單 
                            </li>
                            <li><a class="dropdown-item dropdown-item-link nav-link" href="#">Another action</a>
                            </li>
                        </ul>
                    </li>
                     <li class="nav-item">
                        <a class="nav-link" service="about">About</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#about" id="navbarScrollingDropdown"
                            data-bs-toggle="dropdown" aria-expanded="false">TestDropDown</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarScrollingDropdown">
                            <li><a class="dropdown-item dropdown-item-link nav-link" href="#">Services</a></li>
                            <li><a class="dropdown-item dropdown-item-link nav-link" href="#">Another action</a></li>
                            <li>
                                <hr class="dropdown-divider dropdown-item-link nav-link">
                            </li>
                            <li><a class="dropdown-item dropdown-item-link nav-link" href="#">Something else here</a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="#portfolio">Portfolio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Faculty Members</a></li> 
                </ul> -->
            </div>
            <div class="language">
                <ul class="language-navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link language-link" href="#cn" onclick="_SetMainData('cn',set_page);">中</a>
                    </li>
                    <span class="language-sep">|</span>
                    <li class="nav-item">
                        <a class="nav-link language-link" href="#en" onclick="_SetMainData('en',set_page);">EN</a>
                    </li>
                </ul>
            </div>

        </div>
    </nav>
    <!-- 選單 - E 2021/09/17 -->

    <!-- 內容 - S 2021/10/10 -->
    <div id="main"></div>
    <!-- 內容 - E 2021/10/10 -->

    <div class="gototop js-top active">
        <a href="#" class="js-gotop"><i class="fa fa-arrow-up fa-md" aria-hidden="true"></i></a>
    </div>

    <!-- 頁尾 - S 2021/09/17 -->
    <footer class="bg-light py-5">
        <div class="container px-4 px-lg-5">
            <div class="small text-center text-muted">Copyright &copy; - VALOUR</div>
        </div>
    </footer>
    <!-- 頁尾 - E -->

    <script type="text/javascript" src="js/jquery-3.6.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/7232f0dba9.js" crossorigin="anonymous"></script>

    <!-- Bootstrap core JS -->
    <script src="js/bootstrap.bundle.min.js"></script>

    <!-- SimpleLightbox plugin JS -->
    <script type="text/javascript" src="./js/simpleLightbox.min.js"></script>

    <!-- fontawesome JS -->
    <script type="text/javascript" src="./js/fontawesome.js"></script>


    <!-- Core theme JS -->
    <script type="text/javascript" src="./js/scripts.js"></script>
    <script type="text/javascript" src="./js/capstone.js"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2JPCFX7YKM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-2JPCFX7YKM');
    </script>


    <script>
        let set_page = "home";

        $(function () {

            new WOW().init();

            emailjs.init('Yk_XfYkcIUGW4EvP7')

            $("#main").load("./page/" + set_page + ".html");

            // 預設語言 Language
            setTimeout(() => { _SetMainData('cn', set_page); }, 100);

            // Commuinty Button
            GetCommunity()

            // Top Button
            goToTop();
        })


        window.onload = function () {
            setTimeout(() => {
                // 隱藏社群按鈕文字
                $(".sc-7dvmpp-1").css("display", "none");
                $(".sc-7dvmpp-1").hide();

            }, 5000);

            // Model 圖片
            $('.pop').on('click', function () {
                console.log('test')
                $('.imagepreview').attr('src', $(this).find('img').attr('src'));
                $('#imagemodal').modal('show');
            });

            /* 關於我們 - 環境介紹 */

            // var swiper = new Swiper(".mySwiper", {
            //     pagination: {
            //         el: ".swiper-pagination",
            //         clickable: true,
            //         renderBullet: function (index, className) {
            //             return '<span class="' + className + '">' + (index + 1) + "</span>";
            //         },
            //     },
            // });


            $(".scroll-down").on('click', function () {
                $('html,body').animate({ scrollTop: $(".banner").height() }, 1000);
            });
        }

        /* 聯繫我們 - 寄信 - S */
        function SendMail() {
            let txtName = $('#txtName').val();                                          // 姓名
            let txtPhone = $('#txtPhone').val();                                        // 聯絡電話
            let txtEmail = $('#txtEmail').val();                                        // Email
            let txtSchool = $('#txtSchool').val();                                      // 學校
            let ddlGrade = $('#ddlGrade').find("option:selected").text();               // 年級    
            let ddlGemstone = $('#ddlGemstone').find("option:selected").text();         // Project Gemstone
            let ddlInterCourse = $('#ddlInterCourse').find("option:selected").text();   // 國際課程    
            let ddlExamCourse = $('#ddlExamCourse').find("option:selected").text();     // 檢定課程
            let ddlStudy = $('#ddlGrade').find("option:selected").text();               // 留學代辦
            let ddlTime = $('#ddlTime').find("option:selected").text();                 // 方便連絡時段
            let txtOther = $('#txtOther').val();                                        // 其他
            let msg = "";


            let VerifyData = CheckMail(txtName, txtPhone, txtEmail);

            if (VerifyData.length != 0) {
                alert(VerifyData);
            } else {
                msg = "姓名：" + txtName + "<br>" +
                    "聯絡電話：" + txtPhone + "<br>" +
                    "Email：" + txtEmail + "<br>" +
                    "學校：" + txtSchool + "<br>" +
                    "年級：" + ddlGrade + "<br>" +
                    "Project Gemstone：" + ddlGemstone + "<br>" +
                    "國際課程：" + ddlInterCourse + "<br>" +
                    "檢定課程：" + ddlExamCourse + "<br>" +
                    "留學代辦：" + ddlStudy + "<br>" +
                    "方便連絡時段：" + ddlTime + "<br>" +
                    "其他：" + txtOther + "<br>"

                emailjs.send("service_valour", "template_ksnrp2s", {
                    from_name: txtName,
                    to_name: "VALOUR",
                    txtName: txtName,
                    txtPhone: txtPhone,
                    txtEmail: txtEmail,
                    txtSchool: txtSchool,
                    ddlGrade: ddlGrade,
                    ddlGemstone: ddlGemstone,
                    ddlInterCourse: ddlInterCourse,
                    ddlExamCourse: ddlExamCourse,
                    ddlStudy: ddlStudy,
                    ddlTime: ddlTime,
                    txtOther: txtOther,
                });
                alert('寄信成功')
                window.location.reload();
                $("#main").load("./page/contactus.html");
                // 預設語言 Language
                setTimeout(() => { _SetMainData('cn', 'contactus'); }, 100);

            }
        }
        function CheckMail(txtName, txtPhone, txtEmail) {
            let ReturnData = "";
            if (txtName.replace(/(^s*)|(s*$)/g, "").length == 0) {
                ReturnData = '姓名不能為空！\n';
            }
            ReturnData += ValidatePhoneNumber(txtPhone);
            ReturnData += ValidateEmail(txtEmail);
            return ReturnData;
        }

        function validateNumber(val) {
            var re = /^\d{10}$/;
            return re.test(val);
        }

        function ValidatePhoneNumber(txtPhone) {
            let ReturnData = "";
            if (!validateNumber(txtPhone.replace(/\D/g, ""))) {
                ReturnData = '電話號碼必須為十碼！\n';
            }
            return ReturnData;
        }

        function ValidateEmail(txtEmail) {
            let ReturnData = "";
            var emailRegxp = /^([\w]+)(.[\w]+)*@([\w]+)(.[\w]{2,3}){1,2}$/;
            if (emailRegxp.test(txtEmail) != true) {
                ReturnData = 'Email格式錯誤！\n';
            }
            return ReturnData;
        }

        /* 聯繫我們 - 寄信 - E */

        /* 選單切換 - S */
        function ChangePge(page, href) {
            /* Menu 變白底 */
            // $('nav').addClass('navbar-shrink')
            // $('#cs_logo').attr('src', '~/../assets/img/logo.svg')
            // $('.language-sep').attr('style', 'color:#6c757d')


            let VerifyMenu = ""
            let lsMenu = _GetMenu()
            let lsCourse = ""
            let VerifyPage = href == undefined ? page : href;

            if (page == "home") {
                $("nav").removeClass("navbar-shrink");
                $("#cs_logo").attr("src", "~/../assets/img/logo_white.png");
                $(".language-sep").removeAttr("style");
            }

            /* 驗證是否為主分類: -1:否 */
            if (page == "intcourse" || page == "verificationcourse") {
                /* 子分類為主分類 */
                VerifyMenu = 99
            } else {
                VerifyMenu = $.map(lsMenu, function (item, index) {
                    return item.service;
                }).indexOf(VerifyPage);
            }

            if ($(window).width() <= 830) {
                // 行動裝置裝置 - 點擊主分類
                if (!$("#" + page).hasClass("show") && VerifyMenu != -1) {
                    // 主分類點擊第二次
                    if (VerifyMenu != 99) {
                        $("#" + page).next().removeClass("show");

                    } else {
                        $("#" + page).children().removeClass("show");
                    }

                } else if (VerifyMenu == -1) {
                    // 點擊子分類
                    $("#navbarResponsive").removeClass("show");
                    GetPage(page, href);
                }
            } else {
                GetPage(page, href)
            }
        }

        /* 載入頁面 */
        function GetPage(page, href) {
            $("#main").load("./page/" + page + ".html", function (data) {
                _SetMainData("", page);

                /* 關於我們 - 子項目 */
                if (page == "aboutus" && page != href) {
                    event.preventDefault();
                    setTimeout(() => {
                        const hash = '#' + href;
                        console.log('hash', hash)
                        $('html,body').animate({
                            scrollTop: $(hash).offset().top
                        }, 800)
                    }, 500);
                }

                if (page == "sevents") {
                    swiperInstance = new Swiper(".events .swiper-container", {
                        pagination: {
                            el: ".events .swiper-pagination",
                            clickable: true,
                        },
                        navigation: {
                            nextEl: ".swiper-button-next",
                            prevEl: ".swiper-button-prev",
                        },
                        breakpoints: {
                            320: {
                                // screen >= 320px 
                                slidesPerView: 1,
                                spaceBetween: 20,
                            },
                            768: {
                                // screen >= 768px
                                slidesPerView: 2,
                                spaceBetween: 20,
                            },
                            1600: {
                                // screen >= 1280px
                                slidesPerView: 2.5,
                                spaceBetween: 2,
                            },
                        },
                        slidesPerView: 2.1,
                        speed: 800,
                        // loop: true
                    });
                }
            });
        }
        /* 選單切換 - E */
    </script>
</body>

</html>